async function wordcount(e,n,t){async function a(e){return e.replace(/[|｜](.+?)《(.+?)》/g,"$1").replace(new RegExp("[｜|](.+?)《(.+?)》","g"),"$1").replace(/[｜|](.+?)\((\p{scx=Hira}|\p{scx=Kana})\)/gu,"$1").replace(/((?![〜、。〈〉《》「」『』【】〔〕〖〗〘〙〃〆・〓])\p{scx=Han}+)（(\p{scx=Hira}|\p{scx=Kana})+）/gu,"$1").replace(/[|｜]([《\(（])(.+?)([》\)）])/g,"$1$2$3").replace(/#(.+?)__(.+?)__#/g,"$1")}async function c(){let e=0;for(let n of p){let t=new RegExp(`${n[0]}.*?${n[1]}`,"g");e+=(i.match(t)||[""]).join("").length}return e}async function r(e){let n=e.split(new RegExp(`${l.join("|")}|${p.map(e=>e.join("|")).join("|")}`)).filter(e=>!/^$/.test(e)),t=[];return n.length>0?(t=n.map(e=>e.replace(/[\r\n　 \t]/g,"").length),t.reduce((e,n)=>e+n,0)/n.length):0}let l=n||["。","！　","？　","‼　","⁉　","❕　","❗　","❔　","❓　","!　","\\?　"],p=t||[["「","」"],["『","』"],["（","）"]],g=await a(e),i=g.replace(/[\r\n　 \t]/g,""),s=i.length,o=!!/(?![〜、。〈〉《》「」『』【】〔〕〖〗〘〙〃〆・〓])\p{scx=Han}/u.test(i),u=!0===o?i.match(/(?![〜、。〈〉《》「」『』【】〔〕〖〗〘〙〃〆・〓])\p{scx=Han}/gu).join("").length:0;return{total:s,kanji:u,parenthesis:await c(),letterLength:await r(g)}}