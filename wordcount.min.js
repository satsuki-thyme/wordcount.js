async function wordCount(e,n,t){function g(e){return e.replace(/[|｜](.+?)《(.+?)》/g,"$1").replace(new RegExp("[｜|](.+?)《(.+?)》","g"),"$1").replace(new RegExp(`[｜|](.+?)((${h}+))`,"g"),"$1").replace(new RegExp(`(${c}+)（${h}+）`,"g"),"$1").replace(/[|｜]([《\(（])(.+?)([》\)）])/g,"$1$2$3").replace(/#(.+?)__(.+?)__#/g,"$1")}async function r(e,n){return new Promise(t=>{function g(){for(let a=0;a<Object.keys(n).length-1;a++)p[l]!==Object.keys(n)[a]&&!1===c?l<e.length-1?(l++,g()):t(r):p[l]!==Object.keys(n)[a]&&!0===c&&p[l]!==h?(r++,l<e.length-1?(l++,g()):t(r)):p[l]!==Object.keys(n)[a]&&!0===c&&p[l]===h?(r++,c=!1,l<e.length-1?(l++,g()):t(r)):p[l]===Object.keys(n)[a]&&!1===c?(r++,c=!0,h=n[Object.keys(n)[a]],l<e.length-1?(l++,g()):t(r)):p[l]===Object.keys(n)[a]&&!0===c?(r++,l<e.length-1?(l++,g()):t(r)):(console.error("フールプルーフが働きました"),l<e.length-1?(l++,g()):t(r))}let r=0,l=0,c=!1,h="",p=e.split("");g()})}function l(e){let n=new RegExp(`(?<=^|\r|\n|${p.join("|")}).+(\r|\n|${p.join("|")})`,"g"),t=e.match(n)||[],g=[];return t.length>0?(g=t.map(e=>e.replace(/[\r\n　 \t]/g,"").length),g.reduce((e,n)=>e+n,0)/t.length):0}let c="[々〇〻㐀-鿿豈-﫿\ud840-𯰀-\udfff]",h="[぀-ゟ゠-ヿ]",p=n||["。","！　","？　","‼　","⁉　","❕　","❗　","❔　","❓　","!　","\\?　"],a=t||{"「":"」","『":"』","（":"）"},o=g(e),s=o.replace(/[\r\n　 \t]/g,""),$=s.length,u=!!new RegExp(`${c}`).test(s),i=!0===u?s.match(new RegExp(`${c}`,"g")).join("").length:0;return r(s,a).then(e=>({total:$,kanji:i,parenthesis:e,letterLength:l(o)}))}